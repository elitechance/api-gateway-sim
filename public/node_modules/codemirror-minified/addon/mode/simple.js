'use strict';(function(l){"object"==typeof exports&&"object"==typeof module?l(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],l):l(CodeMirror)})(function(l){function r(e,c){if(!e.hasOwnProperty(c))throw Error("Undefined state "+c+" in simple mode");}function q(e,c){if(!e)return/(?:)/;var d="";e instanceof RegExp?(e.ignoreCase&&(d="i"),e=e.source):e=String(e);return new RegExp((!1===c?"":"^")+"(?:"+e+")",d)}function u(e,c){(e.next||e.push)&&r(c,
e.next||e.push);this.regex=q(e.regex);if(c=e.token)if("string"==typeof c)c=c.replace(/\./g," ");else{for(var d=[],a=0;a<c.length;a++)d.push(c[a]&&c[a].replace(/\./g," "));c=d}else c=null;this.token=c;this.data=e}function v(e,c){return function(d,a){if(a.pending){var b=a.pending.shift();0==a.pending.length&&(a.pending=null);d.pos+=b.text.length;return b.token}if(a.local){if(a.local.end&&d.match(a.local.end))b=a.local.endToken||null,a.local=a.localState=null;else{var b=a.local.mode.token(d,a.localState),
f;a.local.endScan&&(f=a.local.endScan.exec(d.current()))&&(d.pos=d.start+f.index)}return b}for(var g=e[a.state],h=0;h<g.length;h++)if(b=g[h],f=(!b.data.sol||d.sol())&&d.match(b.regex)){b.data.next?a.state=b.data.next:b.data.push?((a.stack||(a.stack=[])).push(a.state),a.state=b.data.push):b.data.pop&&a.stack&&a.stack.length&&(a.state=a.stack.pop());if(b.data.mode){var g=void 0,m=c,h=a,k=b.data.mode,n=b.token;if(k.persistent)for(var p=h.persistentStates;p&&!g;p=p.next)if(k.spec?t(k.spec,p.spec):k.mode==
p.mode)g=p;m=g?g.mode:k.mode||l.getMode(m,k.spec);p=g?g.state:l.startState(m);k.persistent&&!g&&(h.persistentStates={mode:m,spec:k.spec,state:p,next:h.persistentStates});h.localState=p;h.local={mode:m,end:k.end&&q(k.end),endScan:k.end&&!1!==k.forceEnd&&q(k.end,!1),endToken:n&&n.join?n[n.length-1]:n}}b.data.indent&&a.indent.push(d.indentation()+c.indentUnit);b.data.dedent&&a.indent.pop();if(2<f.length){a.pending=[];for(g=2;g<f.length;g++)f[g]&&a.pending.push({text:f[g],token:b.token[g-1]});d.backUp(f[0].length-
(f[1]?f[1].length:0));return b.token[0]}return b.token&&b.token.join?b.token[0]:b.token}d.next();return null}}function t(e,c){if(e===c)return!0;if(!e||"object"!=typeof e||!c||"object"!=typeof c)return!1;var d=0,a;for(a in e)if(e.hasOwnProperty(a)){if(!c.hasOwnProperty(a)||!t(e[a],c[a]))return!1;d++}for(a in c)c.hasOwnProperty(a)&&d--;return 0==d}function w(e,c){return function(d,a,b){if(d.local&&d.local.mode.indent)return d.local.mode.indent(d.localState,a,b);if(!(b=null==d.indent||d.local)&&(b=c.dontIndentStates)){a:{b=
c.dontIndentStates;for(var f=0;f<b.length;f++)if(b[f]===d.state){b=!0;break a}b=void 0}b=-1<b}if(b)return l.Pass;b=d.indent.length-1;f=e[d.state];a:for(;;){for(var g=0;g<f.length;g++){var h=f[g];if(h.data.dedent&&!1!==h.data.dedentIfLineStart){var m=h.regex.exec(a);if(m&&m[0]){b--;if(h.next||h.push)f=e[h.next||h.push];a=a.slice(m[0].length);continue a}}}break}return 0>b?0:d.indent[b]}}l.defineSimpleMode=function(e,c){l.defineMode(e,function(d){return l.simpleMode(d,c)})};l.simpleMode=function(e,c){r(c,
"start");var d={},a=c.meta||{},b=!1,f;for(f in c)if(f!=a&&c.hasOwnProperty(f))for(var g=d[f]=[],h=c[f],m=0;m<h.length;m++){var k=h[m];g.push(new u(k,c));if(k.indent||k.dedent)b=!0}e={startState:function(){return{state:"start",pending:null,local:null,localState:null,indent:b?[]:null}},copyState:function(a){var b={state:a.state,pending:a.pending,local:a.local,localState:null,indent:a.indent&&a.indent.slice(0)};a.localState&&(b.localState=l.copyState(a.local.mode,a.localState));a.stack&&(b.stack=a.stack.slice(0));
for(var c=a.persistentStates;c;c=c.next)b.persistentStates={mode:c.mode,spec:c.spec,state:c.state==a.localState?b.localState:l.copyState(c.mode,c.state),next:b.persistentStates};return b},token:v(d,e),innerMode:function(a){return a.local&&{mode:a.local.mode,state:a.localState}},indent:w(d,a)};if(a)for(var n in a)a.hasOwnProperty(n)&&(e[n]=a[n]);return e}});
